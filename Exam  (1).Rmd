---
title: "Final Exam ML PT2"
output: html_document
date: "2022-08-14"
---

Correlation Plot
```{r setup, include=FALSE}
library(ggplot2)
library(ggthemes)
library(cluster)
library(fpc)
library(reshape2)
library(RCurl)
library(foreach)
library('corrplot')


soical_marketing_file = '~/Desktop/social_marketing.csv'
social_marketing_raw <- read.csv(soical_marketing_file)
social_marketing <- read.csv(soical_marketing_file)
```

```{r}
cor = round(cor(social_marketing_raw[,2:37]), 2)
corrplot(cor, method="square")
```

The plot at first glance will just show us what how many and what variables are showing a correlation. We see that many of the variables are correlated. For example, the plot is showing us that college uni and online gaming are correlated. We also see that health nutrition and personal fitness are correlated as well.

We can use the principal component analysis to summarize the information content in large data tables by means of a smaller set of “summary indices” that can be more easily visualized and analyzed.

```{r}
social_marketing$chatter<- NULL
social_marketing$spam <- NULL
social_marketing$health_nutrition <- NULL 
social_marketing$photo_sharing <- NULL
social_marketing$adult <- NULL

scaled_var = social_marketing[,(2:32)]
scaled_var = scale(scaled_var, center=TRUE, scale=TRUE)

mu = attr(scaled_var,"scaled:center")
sigma = attr(scaled_var,"scaled:scale")
```

We've centered and scaled the data and extracted them which will be the attributes. 

```{r}

pca = prcomp(social_marketing_raw[,2:32], scale=TRUE, center = TRUE)

summary(pca)

pca_1 <-  pca$sdev ^ 2
pca_2 <- pca_1 / sum(pca_1)

plot(cumsum(pca_2), xlab = "Principal Component", 
     ylab = "Variance Explained")
cumsum(pca_2)[10]
```

Looking at the 10th principal component we can see that roughly 64.6% of the fraction of variance is explained. Using the Kaiser Criterion we can drop all Eigen values under 1.0. 

```{r}
set.seed(123)

k.max = 15
data = scaled_var

cluster1 = kmeans(scaled_var, 10, nstart=25)

social_cluster1 = cbind(social_marketing, cluster1$cluster)

plotcluster(social_marketing[,2:32], cluster1$cluster)
```

Using the elbow method we've determine the number of clusters. We've decided to move forward with 10 clusters. 


```{r}

social_cluster1_main = as.data.frame(cbind(cluster1$center[1,]*sigma + mu, 
                                          cluster1$center[2,]*sigma + mu,
                                          cluster1$center[3,]*sigma + mu,
                                          cluster1$center[4,]*sigma + mu,
                                          cluster1$center[5,]*sigma + mu,
                                          cluster1$center[6,]*sigma + mu,
                                          cluster1$center[7,]*sigma + mu,
                                          cluster1$center[8,]*sigma + mu,
                                          cluster1$center[9,]*sigma + mu,
                                          cluster1$center[10,]*sigma + mu))

summary(social_cluster1_main)

names(social_cluster1_main) <- c('Cluster_1',
                               'Cluster_2',
                               'Cluster_3',
                               'Cluster_4',
                               'Cluster_5',
                               'Cluster_6',
                               'Cluster_7',
                               'Cluster_8',
                               'Cluster_9',
                               'Cluster_10')

```

```{r}
social_cluster1_main$type = row.names(social_cluster1_main)
#Cluster 1
ggplot(social_cluster1_main, aes(x =reorder(type, -Cluster_1) , y=Cluster_1)) +
  geom_bar(stat="identity", position ="dodge") + 
  theme_economist() + 
  theme(axis.text.x = element_text(angle=-42, hjust=.2)) + 
  labs(title="Cluster 1",
       x ="Category", y = "Centre Values")
```
Cluster 1 primarily composed with people who have interest in current_events, traveling and politics. 

```{r}
#Cluster 2 
ggplot(social_cluster1_main, aes(x =reorder(type, -Cluster_2) , y=Cluster_2)) +
  geom_bar(stat="identity", position ="dodge") + 
  theme_economist() + 
  theme(axis.text.x = element_text(angle=-42, hjust=.2)) + 
  labs(title="Cluster 2",
       x ="Category", y = "Cluster Centre")
```
Cluster 2 primarily composed with people who have interest in shopping, current_events, college_uni. 

```{r}
#Cluster 3
ggplot(social_cluster1_main, aes(x =reorder(type, -Cluster_3) , y=Cluster_3)) +
  geom_bar(stat="identity", position ="dodge") + 
  theme_economist() + 
  theme(axis.text.x = element_text(angle=-42, hjust=.2)) + 
  labs(title="Cluster 3",
       x ="Category", y = "Cluster Centre")
```
Cluster 3 emphasized people who have interest in dating then followed by fashion.

```{r}
#Cluster 4
ggplot(social_cluster1_main, aes(x =reorder(type, -Cluster_4) , y=Cluster_4)) +
  geom_bar(stat="identity", position ="dodge") + 
  theme_economist() + 
  theme(axis.text.x = element_text(angle=-42, hjust=.2)) + 
  labs(title="Cluster 4",
       x ="Category", y = "Cluster Centre")
```
Cluster 4 primarily composed of people who have interest in sports_fandom, relition, and parenting.


```{r}
#Cluster 5
ggplot(social_cluster1_main, aes(x =reorder(type, -Cluster_5) , y=Cluster_5)) +
  geom_bar(stat="identity", position ="dodge") + 
  theme_economist() + 
  theme(axis.text.x = element_text(angle=-42, hjust=.2)) + 
  labs(title="Cluster 5",
       x ="Category", y = "Cluster Centre")
```
Cluster 5 primarily composed of people who have interest in cooking, fashion and beauty. 


```{r}
#Cluster 6
ggplot(social_cluster1_main, aes(x =reorder(type, -Cluster_6) , y=Cluster_6)) +
  geom_bar(stat="identity", position ="dodge") + 
  theme_economist() + 
  theme(axis.text.x = element_text(angle=-42, hjust=.2)) + 
  labs(title="Cluster 6",
       x ="Category", y = "Cluster Centre")
```
Cluster 6 primarily composed of people who have interest in college_unit, online gaming and sports_playing. 

```{r}
#Cluster 7
ggplot(social_cluster1_main, aes(x =reorder(type, -Cluster_7) , y=Cluster_7)) +
  geom_bar(stat="identity", position ="dodge") + 
  theme_economist() + 
  theme(axis.text.x = element_text(angle=-42, hjust=.2)) + 
  labs(title="Cluster 7",
       x ="Category", y = "Cluster Centre")
```
Cluster 7 primarily composed of people who have interest in art, tv_film, and current_events. 

```{r}
#Cluster 8
ggplot(social_cluster1_main, aes(x =reorder(type, -Cluster_8) , y=Cluster_8)) +
  geom_bar(stat="identity", position ="dodge") + 
  theme_economist() + 
  theme(axis.text.x = element_text(angle=-42, hjust=.2)) + 
  labs(title="Cluster 8",
       x ="Category", y = "Cluster Centre")
```
Cluster 8 primarily composed of people who have interest in news, politics, and automotive. 


```{r}
#Cluster 9
ggplot(social_cluster1_main, aes(x =reorder(type, -Cluster_9) , y=Cluster_9)) +
  geom_bar(stat="identity", position ="dodge") + 
  theme_economist() + 
  theme(axis.text.x = element_text(angle=-42, hjust=.2)) + 
  labs(title="Cluster 9",
       x ="Category", y = "Cluster Centre")
```
Cluster 9 primarily composed of people who have interest in politics, travel, computers. 

```{r}
#Cluster 10
ggplot(social_cluster1_main, aes(x =reorder(type, -Cluster_10) , y=Cluster_10)) +
  geom_bar(stat="identity", position ="dodge") + 
  theme_economist() + 
  theme(axis.text.x = element_text(angle=-42, hjust=.2)) + 
  labs(title="Cluster 10",
       x ="Category", y = "Cluster Centre") 
```
Cluster 10 primarily composed of people who have interest in personal_fitness, cooking, outdoors.

K-Means clustering can allow us to identify the different market segments. In this case, we used 10 
Based on the K-Means clustering, we can identify distinct market segments that NutrientH20 can potentially leverage to design specific marketing campaigns. 
