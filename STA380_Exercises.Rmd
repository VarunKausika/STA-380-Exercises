---
title: "STA-380 Exercises"
output: pdf_document
date: "2022-08-10"
author: "Varun Kausika"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

\section{1. Probability practice}

\subsection{Part A}

**Given information:** 

Two categories of users: 

1. Truthful clicker (TC) 
2. Random clicker (RC)

**Information on probablities:**

\begin{itemize}
\item $P(RC) = 0.3$
\item $P(Yes|RC) = 0.5$
\item $P(No|RC) = 0.5$
\item $P(TC) = 0.7$
\item $P(Yes|TC) = x$
\item $P(No|TC) = 1-x$
\item $P(Yes) = 0.65$
\item $P(No) = 0.35$
\end{itemize}

*Using the Rule of Total Probability*, 

\begin{equation}
P(Yes) = P(Yes, TC) + P(Yes, RC) = P(TC)*P(Yes|TC) + P(RC)*P(Yes|RC)
\label{eqn:A_1}
\end{equation}

\begin{equation*}
P(Yes) = 0.7x + 0.3*0.5 = 0.7x + 0.15 = 0.65
\end{equation*}

Solving for x, we get, 

**$x = P(Yes|TC) = 0.714$** 

\subsection{Part B}

We are being asked $P(Diseased|Positive)$

**Given information:**

\begin{itemize}
\item $P(Positive|Diseased) = 0.993$
\item $P(Negative|Not Diseased) = 0.9999$
\item $P(Diseased) = 0.000025$
\end{itemize}

*According to Bayes Rule and Rule of Total Probability*,

\begin{equation}
P(Diseased|Positive) = \frac{P(Positive|Diseased)*P(Diseased)}{P(Positive)}
\label{eqn:B_1}
\end{equation}

and, 

\begin{equation}
P(Positive) = P(Positive|Diseased)*P(Diseased) + P(Positive|Not\:Diseased)*P(Not\:Diseased)
\label{eqn:B_2}
\end{equation}

Therefore, 

\begin{equation*}
P(Positive) = 0.993*0.000025 + 0.0001*0.999975 = 0.000125
\end{equation*}

Substituting in \eqref{eqn:B_1} we get, 

\begin{equation*}
P(Diseased|Positive) = \frac{0.993*0.000025}{0.000125} = \boldmath{0.1986}
\end{equation*}

\section{2. Wrangling the Billboard Top 100}

\subsection{Part A}

**First, we load in the data and perform a group by on the performer and the song, with an agg function of count for the week**

```{r, echo=FALSE}
df = read.csv('billboard.csv')
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(dplyr)

grouped_df = df %>% group_by(performer, song) %>% summarize_at(vars(week), funs(length)) 
grouped_df = grouped_df %>% rename(count=week)
knitr::kable(head(grouped_df, 10), caption="Billboards")
```

**Finally, we sort the dataframe in descending order of counts and find the top 10 and give our table a caption:**

```{r, echo= FALSE}
top_10 = grouped_df[order(grouped_df$count, decreasing=TRUE),][1:10,]
```

```{r, echo=FALSE}
knitr::kable(top_10, caption="Top 10 most popular songs")
```

\subsection{Part B}

First we group by year and order by ascending year. Then, we remove the years 1958 and 2021 from the rows and order just to make sure. Finally, we proceed to plot the columns.

```{r, echo=FALSE}
grouped_df_2 = df %>% group_by(year) %>% summarise(n_distinct(song))
grouped_df_2 = grouped_df_2[grouped_df_2$year!= 1958, ]
grouped_df_2 = grouped_df_2[grouped_df_2$year!= 2021, ]
grouped_df_2 = grouped_df_2[order(grouped_df_2$year, decreasing=FALSE),]
```

```{r plot, fig.cap='The plot shows peaks in diversity in 1965 and 2020, along with extreme lows in 2000', echo=FALSE}
div_years = plot(grouped_df_2$year, grouped_df_2$`n_distinct(song)`, type = 'l', xlab = 'Year', ylab = 'Musical Diversity')
```
\subsection{Part C}

First, we filter the dataframe from part A to include only those songs with weeks at least 10. Then, We do a group by on the artists. Finally, we can select those artists with a hit-count of at least 30. 
```{r, echo=FALSE}
ten_week_hits = grouped_df[grouped_df$count>=10,]
```

```{r, echo= FALSE}
grouped_df_3 = ten_week_hits %>% group_by(performer) %>% summarize_at(vars(song), funs(length))
artists_19 = grouped_df_3[grouped_df_3$song>=30, ]
```
```{r plot2, echo=FALSE, fig.cap='Elton John has more hits than others by quite a large margin'}
library(ggplot2)
ggplot(data=artists_19, aes(x=performer, y=song)) + geom_bar(stat="identity", fill="steelblue") + theme(axis.text.x=element_text(angle = -90, hjust = 0)) + labs(y = "Number of 10-week hits")
```



